<!DOCTYPE html>
<html th:with="language=${#locale.language}" th:lang="en"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{template}">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Cadastro | Loja de Utilidades Domésticas</title>
</head>
<body>

<th:block layout:fragment="pageContent">

    <div class="container-fluid mt-4">

        <div class="row pt-3 flex-row">
            <div class="col-8">
                <div class="row flex-row">
                    <div class="col-8 d-flex justify-content-start">
                        <h3>Carrinho de compras</h3>
                    </div>
                    <div class="col-4 d-flex justify-content-end">
                        <h5 class="text-muted pb-0 mb-0">Preço</h5>
                    </div>
                </div>
                <hr class="mt-0 mb-3"/>

                <div class="container-fluid">

                    <!-- LIST ALL PRODUCTS OF SHOP CART -->
                    <div th:each="item : ${shopCart.items}"
                         class="row flex-row pl-4">

                        <div class="col-12">
                            <div class="row flex-row">
                                <div class="col-2 d-flex justify-content-start">
                                    <img th:src="${item.product.imageUrl}" class="img-thumbnail rounded"/>
                                </div>
                                <div class="col-7">
                                    <div class="row">
                                        <div class="col-12">
                                            <a th:text="${item.product.title}"
                                               th:href="@{/shop/product/details?id=} + ${item.product.id}"
                                               class="btn btn-link pl-0"
                                               style="font-size: 20px">
                                            </a>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-3">
                                            <form th:action="@{/shop/cart}" method="post" class="form-inline w-50">
                                                <div class="form-group">
                                                    <input type="hidden" name="operation" th:value="update">

                                                    <input type="hidden"
                                                           name="id"
                                                           th:value="${item.id}">

                                                    <label th:for="'inputItemAmount' + ${item.id}" class="mr-3">QTD.</label>
                                                    <input type="number"
                                                           class="form-control w-25"
                                                           name="amount"
                                                           min="1"
                                                           th:id="'inputItemAmount' + ${item.id}"
                                                           th:value="${item.amount}">
                                                </div>
                                                <button type="submit" class="btn btn-link">Atualizar</button>
                                            </form>
                                        </div>
                                        <div class="col-3">
                                            <form th:action="@{/shop/cart}" method="get" class="form-inline w-50">
                                                <input type="hidden" name="operation" th:value="remove">
                                                <input type="hidden" name="productId" th:value="${item.product.id}">
                                                <button type="submit" class="btn btn-link pl-0">
                                                    Excluir
                                                </button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-3 d-flex justify-content-end">
                                    <span th:text="${#strings.replace(#numbers.formatCurrency(item.subtotal), '$', 'R$')}"
                                          class="font-weight-bold"
                                          style="font-size: large"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <!-- END LIST PRODUCTS OF SHOP CART -->

                <div class="row flex-row">
                    <div class="col-12">
                        <div class="d-flex justify-content-end text-dark" style="font-size: 25px">
                            <span>Total (<span th:text="${shopCart.itemsAmount}"></span> itens):</span>
                            <span th:text="${#strings.replace(#numbers.formatCurrency(shopCart.total), '$', 'R$')}" class="ml-1 font-weight-bold"></span>
                        </div>
                    </div>
                </div>

            </div>

            <div class="col-4">
                <div class="card">
                    <div class="card-body" style="font-size: 20px">
                        <span>Total (<span th:text="${shopCart.itemsAmount}"></span> itens):</span>
                        <span th:text="${#strings.replace(#numbers.formatCurrency(shopCart.total), '$', 'R$')}" class="ml-1 font-weight-bold"></span>
                    </div>
                    <div class="card-footer">
                        <a th:href="@{/shop/checkout/step/one}"
                           class="btn btn-info btn-lg btn-block"
                        >Fechar pedido</a>
                    </div>
                    <div class="card-footer">
                        <a th:href="@{/shop/product/list}"
                           class="btn btn-warning btn-lg btn-block text-dark"
                        >Continuar comprando</a>
                    </div>
                </div>
            </div>
        </div>

    </div>

</th:block>

</body>
</html>
